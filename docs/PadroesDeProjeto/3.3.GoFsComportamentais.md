# 3.3. GoFs Comportamentais

## Sum√°rio
- [3.3. GoFs Comportamentais](#33-gofs-comportamentais)
  - [Sum√°rio](#sum√°rio)
  - [Metodologia](#metodologia)
  - [Diagrama antes e depois](#diagrama-antes-e-depois)
    - [Command](#command)
  - [C√≥digo](#c√≥digo)
    - [Imagens C√≥digo do Command](#imagens-c√≥digo-do-command)
  - [C√≥digo rodando](#c√≥digo-rodando)
    - [Command](#command-1)
  - [Conclus√£o](#conclus√£o)
  - [Refer√™ncias](#refer√™ncias)
  - [Hist√≥rico de Vers√µes](#hist√≥rico-de-vers√µes)

---

## Metodologia
Com base nos requisitos e funcionalidades do projeto, foram analisados os padr√µes de projeto GoF comportamentais, visando identificar sua aplicabilidade pr√°tica na arquitetura da aplica√ß√£o ([**Ata de Reuni√£o [28/05]**](https://unbbr-my.sharepoint.com/:w:/g/personal/211062947_aluno_unb_br/EYGy8GTOqkNMpRsLkU-5HDwBDVmftU37wUpjHNnvadjg3g?e=F9YIql)). A partir dessa an√°lise, o padr√£o Command foi adotado para o desenvolvimento do player de √°udio, conforme descrito e justificado a seguir:

- Command: O padr√£o Command foi aplicado no player de √°udio para encapsular cada a√ß√£o do usu√°rio (como play, pause, next, previous) em objetos separados que cont√™m todas as informa√ß√µes necess√°rias para executar essas opera√ß√µes. Essa abordagem permite tratar comandos como objetos independentes, facilitando o gerenciamento da fila de reprodu√ß√£o, o controle da ordem e o poss√≠vel suporte a opera√ß√µes de desfazer/refazer.
  - [**Implementa√ß√£o - Player**](https://github.com/UnBArqDsw2025-1-Turma01/2025.1-T01-_G7_FCTEPodcast/tree/main/fctepodcast-frontend/src/context/player)

- Observer: O padr√£o Observer foi escolhido para o sistema de notifica√ß√µes, visando permitir que m√∫ltiplos objetos sejam notificados automaticamente sobre eventos relevantes, como curtidas ou coment√°rios em epis√≥dios de podcasts. Essa abordagem estabelece um mecanismo de assinatura em que o professor, enquanto autor do conte√∫do, atua como assinante que recebe notifica√ß√µes sempre que um aluno interage com seus epis√≥dios. Embora essa funcionalidade ainda n√£o tenha sido implementada, ela ser√° planejada e modelada de acordo com o padr√£o Observer.


Durante as reuni√µes de equipe realizadas ao longo do desenvolvimento do projeto, que est√£o devidamente documentadas em atas, discutimos de forma criteriosa sobre o melhor padr√£o comportamental para utilizarmos em nosso site.

Ap√≥s uma an√°lise t√©cnica aprofundada dos principais padr√µes de projeto comportamentais, optamos pela ado√ß√£o do padr√£o Command, do cat√°logo GoF, por apresentar a melhor adequa√ß√£o aos requisitos da aplica√ß√£o.

-**Command"": Utilizado para implementar as funcionalidades da barra de controle de √°udio do site de podcast, como pausar, avan√ßar e retroceder epis√≥dios. Permitindo modelar cada requisi√ß√£o como um objeto.

## Diagrama antes e depois
### Command
![Diagrama do Command](./_media/Command.png)

## C√≥digo
### Imagens C√≥digo do Command

![command](_media/Command/Command/command.png)

![pausecommand](_media/Command/Command/pausecommand.png)

Esta classe segue a estrutura b√°sica do padr√£o Command, onde uma opera√ß√£o espec√≠fica (no caso, pausar) √© encapsulada como um objeto independente.

A classe possui um atributo privado player do tipo Player, que √© injetado atrav√©s do construtor. Essa inje√ß√£o de depend√™ncia permite que o comando atue sobre a inst√¢ncia correta do player. O m√©todo execute(), obrigat√≥rio em implementa√ß√µes do padr√£o Command, cont√©m a l√≥gica para executar a a√ß√£o de pausar, simplesmente delegando essa opera√ß√£o para o m√©todo pause() do player armazenado.

![PlayerClass](_media/Command/Command/PlayerClass.png)

A classe tem como prop√≥sito gerenciar a reprodu√ß√£o de uma sequ√™ncia de epis√≥dios de √°udio (playlist), fornecendo:

  - Controle de reprodu√ß√£o (play/pause)

  - Navega√ß√£o entre faixas (next/previous)

  - Notifica√ß√£o de mudan√ßas de faixa

  - Manuten√ß√£o do estado atual do player

![playercontext](_media/Command/Command/playercontext.png)

Esse padr√£o permite encapsular uma a√ß√£o (como tocar ou pausar uma faixa) dentro de um objeto, o que facilita passar comandos como par√¢metros, registrar listas de a√ß√µes, e at√© mesmo desfazer opera√ß√µes. Isso √© √∫til para tornar o player mais flex√≠vel e reutiliz√°vel.

A l√≥gica central do player est√° concentrada dentro de um contexto React, chamado PlayerContext, que exp√µe tanto o estado atual do player quanto as fun√ß√µes de controle. Por meio desse contexto, os componentes filhos conseguem acessar e modificar o que est√° tocando, o tempo atual da faixa, o volume, entre outras propriedades. Para garantir que esses valores n√£o sejam recriados a cada renderiza√ß√£o, alguns elementos como o player de fato s√£o armazenados usando useRef.

Quando um novo caminho de √°udio √© definido, o player faz o carregamento do arquivo correspondente. Esse processo √© tratado de forma ass√≠ncrona, e o estado loadingAudio √© usado para mostrar visualmente que o carregamento est√° em andamento.

O c√≥digo usa useCallback para evitar que fun√ß√µes como playAudio, handleVolumeChange ou handleEnd sejam recriadas desnecessariamente. Essas fun√ß√µes s√£o respons√°veis por lidar com a√ß√µes comuns: iniciar ou pausar o √°udio, ajustar o volume, pular para um tempo espec√≠fico da faixa, ou lidar com o final da reprodu√ß√£o.

Tamb√©m h√° um hook chamado usePlayer, que serve como uma maneira pr√°tica e segura de acessar o contexto do player dentro de outros componentes. Esse hook lan√ßa um erro caso seja usado fora do PlayerProvider, para garantir que ele s√≥ funcione dentro do escopo certo.

Adaptamos o padr√£o Command, j√° que no React n√£o usamos classes com m√©todos como em linguagens orientadas a objetos tradicionais. Em vez disso, usamos fun√ß√µes e closures. As a√ß√µes que seriam m√©todos de um objeto s√£o passadas como fun√ß√µes diretamente pelo contexto. Os componentes que consomem essas fun√ß√µes acabam se tornando "clientes" do player, usando os comandos de forma desacoplada da implementa√ß√£o interna.

## C√≥digo rodando

### Command

A seguir, √© apresentada a demonstra√ß√£o da implementa√ß√£o do padr√£o de projeto Command, j√° devidamente integrada e funcional na aplica√ß√£o. Esse padr√£o foi aplicado no componente de Player de √Åudio, permitindo a execu√ß√£o encapsulada dos comandos de play, pause, pr√≥ximo e anterior.

<iframe width="560" height="315" src="https://www.youtube.com/embed/Ra1PAchKcGI?si=7Ne_CfUSmUaB4dGw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

## Conclus√£o

A aplica√ß√£o do padr√£o Command no player de √°udio permitiu organizar de forma clara e flex√≠vel as a√ß√µes do usu√°rio, como tocar, pausar e trocar faixas. Mesmo em um contexto funcional como o React, o padr√£o foi adaptado com sucesso por meio de contextos e fun√ß√µes reutiliz√°veis, mantendo os princ√≠pios de desacoplamento e coes√£o. Al√©m disso, o padr√£o Observer foi escolhido para o futuro sistema de notifica√ß√µes, refor√ßando uma arquitetura reativa e escal√°vel. 

A ado√ß√£o dos padr√µes comportamentais contribuiu diretamente para uma estrutura mais alinhada √†s boas pr√°ticas de desenvolvimento.

## Refer√™ncias

### üîß Padr√µes Estruturais

- [Refactoring Guru ‚Äì Design Patterns: Padr√µes Comportamentais](https://refactoring.guru/design-patterns/behavioral-patterns)  

- [Refactoring Guru ‚Äì Facade Command](https://refactoring.guru/design-patterns/command)  

### üéì Material da Professora
z
- [Material de Apoio - UNB Moodle](https://aprender3.unb.br/mod/page/view.php?id=1372236)  
  P√°gina com material complementar utilizado em sala de aula sobre padr√µes de projeto.

---

## Hist√≥rico de Vers√µes

| Vers√£o |    Data    |        Descri√ß√£o         |    Autor(es)    |  Revisor(es)     |  Detalhes da Revis√£o  |  
| :----: | :--------: | :----------------------: | :-------------: | :----------------| :---------------------|
|  1.0   | 31/05/2025 |   Cria√ß√£o do documento   | Nat√°lia Rodrigues | Harleny A. | Arquiteura de pastas revisada |
|  1.1   | 31/05/2025 |   Adi√ß√£o de C√≥digos em imagens   | Gustavo C., Harleny A., Iderlan J., Rafael K. | ---- | -----|
|  1.2   | 01/06/2025 | Adi√ß√£o do conte√∫do da se√ß√£o de metodologia | Marcella Anderle, Gustavo C | Gustavo C. |  Adicionando Elos as funcionalidades implementadas|
|  1.3   | 01/06/2025 | Explica√ß√£o dos C√≥digos | Nat√°lia Rodrigues | | |
|  1.4   | 01/06/2025 | Adicionando diagramas | Rafael Kenji | | |
|  1.5   | 01/06/2025 | Adicionando conclus√£o | Marcella Anderle | | |
| 1.6  | 01/06/2025  | Adi√ß√£o de V√≠deos de demonstra√ß√£o | Gustavo C., Rafael K., Iderlan J., Marcella Anderle, Harleny A. |
| 1.7  | 01/06/2025  | Revis√£o dos textos | Nat√°lia Rodrigues, Gustavo Costa, Marcella Anderle|   Gustavo C., Rafael K., Iderlan J., Marcella Anderle, Harleny A. |  Revis√£o de todos os textos        | 
|1.8|	02/06/2025	|Adi√ß√£o de Refer√™ncias| Harleny Ang√©llica|	Gustavo Costa|Texto Revisado |